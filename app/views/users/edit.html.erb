<% provide(:title, "Edit user") %> 
<h1>Update your profile</h1>

<div class="row">
  <div class="span6 offset3">
  <%= form_for @user do |f| %>
      <%= render 'shared/error_messages', object: f.object %>

      <fieldset>
        <legend>
          User Info
        </legend>
        <div class="clearfix-placeholder"></div>
        <div class="control-group">
          <%= f.label :name, class: "control-label", for: "user_name" %>
          <div class="controls">
            <%= f.text_field :name, class: "input-xlarge" %>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :email, class: "control-label", for: "user_email" %>
          <div class="controls">
            <%= f.text_field :email, class: "input-xlarge" %>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :password, class: "control-label", for: "user_password" %>
          <div class="controls">
            <%= f.password_field :password, class: "input-xlarge" %>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :password_confirmation, "Confirm Password", class: "control-label", for: "user_password_confirmation" %>
          <div class="controls">
            <%= f.password_field :password_confirmation, class: "input-xlarge" %>
          </div>
        </div>

        <% if !session['access_secret'].nil? && !session['access_token'].nil?%>
          <%= f.hidden_field :twitter_atoken, value: session['access_token'] %>
          <%= f.hidden_field :twitter_asecret, value: session['access_secret'] %>
        <% end %>  

        <div class="form-actions">
          <%= f.submit "Save changes", class: "btn btn-medium" %>
        </div>  

      </fieldset>  
      
    <% end %>

    <fieldset>
        <legend>
          Twitter
        </legend>
        <% if !@user.twitter_authorized? && !session['access_secret'].nil? && !session['access_token'].nil? %>
          <div class="alert alert-block">
            <h4 class="alert-heading">Almost there!</h4>
            You'll still need to save your changes.
        <% elsif !@user.twitter_authorized? && session['access_secret'].nil? && session['access_token'].nil? %>
          <div class="form-actions">
            <%= link_to "Twitter sign in", new_twittersession_path, class: "btn btn-medium btn-info" %>
          </div>
        <% elsif @user.twitter_authorized? %>
          <div class="alert alert-success">
            <h4 class="alert-heading">Hi <%= @client.user.name %>!</h4>
            You are currently authorized as <b><%= @client.user.screen_name %></b> 
        <% end %>  
    </fieldset>

    <fieldset>
        <legend>
          Gravatar
        </legend>
        <div class="thumbnail">
          <%= gravatar_for @user %>
          <div class="caption">
            <p style="padding-top: 20px; padding-bottom: 20px; ">
              <a href="http://gravatar.com/emails">change</a>
            </p>  
          </div>
        </div>  
    </fieldset>
  </div>
</div>
