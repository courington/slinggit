<article class="col4 pull_left white_well">
  <%= form_for @post do |f| %>
      <%= render 'shared/error_messages', object: f.object %>

      <!-- item name -->
      <fieldset class="row">

        <%= f.label :hashtag_prefix, "Your item", class: "col6", for: "post_hashtag_prefix" %>

        <div class="col6">
          <%= f.text_field :hashtag_prefix, class: "hardEdge-right col4 pull_left", placeholder: "#", maxLength: "15", counterMax: "15" %>
          <span class="col2 pull_right add_on">forsale</span>
        </div>

      </fieldset>
      <!-- end item name -->


      <!-- price and location -->
      <div class="row">

        <fieldset class="col3 pull_left">
          <%= f.label :price, class: "row", for: "post_price" %>
          <div class="row">
            <%= f.text_field :price, class: "hardEdge-right col4 pull_left", id: "post_price", placeholder: "$", maxLength: "6"  %>
            <span class="col2 pull_right add_on">.00</span>
          </div>
        </fieldset>

        <fieldset class="col3 pull_right">
          <%= f.label :location, "Location", class: "row", for: "post_hashtag_prefix" %>
          <%= f.text_field :location, class: "row", placeholder: "City, State, or Zip", maxLength: "16", counterMax: "16"  %>
        </fieldset>

      </div>
      <!-- end price and location  -->


      <!-- description -->
      <fieldset class="row">

        <%= f.label :content, "Quick description", class: "col3", for: "post_content" %>
        <%= f.text_area :content, class: "row", rows: "3", counterMax: "300" %>

      </fieldset>
      <!-- end description -->


      <!-- photo and twitter -->
      <div class="row">

        <fieldset id="photoControlGroup" class="col3">
          <%= f.label :photo, "Item Photo (optional)", class: "", for: "post_photo" %>
          <div class="controls thumbnail">
            <!--[if lt IE 9]>
					<%= f.file_field :photo %>
				<![endif]-->
            <!--[if gt IE 9]><!-->
            <%= f.file_field :photo, style: "position:absolute; top:-999px; left:-999px" %>
            <a href="#" id="fileSelect">Select a photo</a>
            <!--<![endif]-->
          </div>
        </fieldset>

        <fieldset class="col3 twitterPostAccount">
          <span>Social network(s) to post to:</span>
          <%= check_box_tag "twitter_accounts[#{@slinggit_account_id}]", 'post', true %>
          <span>Twitter - Slinggit</span>
          <% @twitter_accounts.each do |twitter_account| %>
              <%= check_box_tag "selected_networks[#{twitter_account.id}]", 'post', true %>
              <span>Twitter - <%= twitter_account.user_name %></span>
          <% end %>
          <% @facebook_accounts.each do |facebook_account| %>
              <%= check_box_tag "selected_networks[#{facebook_account.id}]", 'post', true %>
              <span>Facebook - <%= facebook_account.user_name %></span>
          <% end %>
        </fieldset>

      </div>
      <!-- end photo and twitter -->


      <fieldset class="row">
        <% if @cant_post %>
            <p id="#notice_explanation_bubble">You have reached your 24 hours post limit.</p>

            <p>Please <%= link_to "contact customer service", contact_path %> if you wish to increase this limit.</p>
            <%= f.button "Post Item", type: "submit", class: "col3 btn", id: "submitNewPost", disabled: "disabled" %>
        <% else %>
            <%= f.button "Post Item", type: "submit", class: "col3 btn btn_green", id: "submitNewPost" %>
            <%= link_to "Cancel", user_path(current_user), class: "col3 btn_ltGrey" %>
        <% end %>
      </fieldset>
  <% end %>
</article>

<script type="text/javascript">

  $('input, textarea').focus(function(field_object){
      if(field_object.target.getAttribute('counterMax') != null){
          displayCounter(field_object.target.id, field_object.target.getAttribute('counterMax'));
      }
  })

  function displayCounter(field_name, max){
      var field_object = $('#' + field_name);
      var counter_object = $('#counter_' + field_name);

      if(counter_object.length == 0){
          field_object.parent().prepend('<div id="counter_' + field_name + '" class="counter col1 pull_right">' + field_object.val().length + '/' + max.toString() + '</div>');
          counter_object = $('#counter_' + field_name);
      }else{
          counter_object.show();
      }

      field_object.blur(function(){
          counter_object.hide();
      }).keyup(function () {
          if(parseInt(field_object.val().length) < max){
              counter_object.html(field_object.val().length + '/' + max);
          }else{
              counter_object.html(max + '/' + max);
              field_object.val(field_object.val().substring(0,300));
          }
      })
  }

</script>