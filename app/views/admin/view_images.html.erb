<% @image_datas.each do |image_data| %>
    <div id="workingDiv">Working... Please Wait (the blinking is just a joke)</div>
    <div id="doneDiv">Done... post and associated user eradicated. Email sent.</div>
    <div id="errorDiv">Done... post and associated user eradicated. Email sent.</div>
    <a href="" id="imagePostId_<%= image_data[:post_id] %>"><img src='<%= "/#{@relative_path}/#{image_data[:image_path]}" %>'/></a>
<% end %>

<script type="text/javascript">

    //here I am coding this shit right in the view again... sorry, still havent taken the time to learn coffee script yet...
    //but you should leave this here so I can see about learning it and moving this over as a good learning experience.
    $(document).ready(function () {
        showHideNotifications();
        $("[id^=imagePostId_]").each(function (key) {
            $('#' + this.id).click(function (e) {
                e.preventDefault();
                if (confirm("By clicking OK, you will be removing any twitter posts that are associated to this image, setting the associated post record to deleted, disabling the posters account and sending a terms violation email to the poster...")) {
                    showHideNotifications('workingDiv')
                    $.ajax({
                        type:"POST",
                        url:"<%= url_for :controller => :admin, :action => :eradicate_all_from_image %>",
                        data:{image_post_id:this.id}
                    }).done(function (response) {
                                if (response.toLowerCase().indexOf("error") != -1) {
                                    $('#errorDiv').html(response)
                                    showHideNotifications('errorDiv')
                                } else {
                                    showHideNotifications('doneDiv')
                                    $('#' + response).hide()
                                }
                            });
                } else {
                    showHideNotifications();
                    return false;
                }
            });
        });
    })

    function showHideNotifications(id) {
        $('#workingDiv').hide();
        $('#doneDiv').hide();
        $('#errorDiv').hide();
        if (id) {
            $('#' + id).show();
        }
    }


</script>

<!-- Chase feel free to delete these when you style this to work on mobile as well. -->

<style type="text/css">
    a {
        float: left;
        padding: 1px;;
    }

    #workingDiv {
        font-size: 20px;
        color: red;
        text-decoration: blink;
        margin-bottom: 20px;
    }

    #errorDiv {
        font-size: 20px;
        color: red;
        margin-bottom: 20px;
    }

    #doneDiv {
        font-size: 20px;
        color: green;
        margin-bottom: 20px;
    }
</style>